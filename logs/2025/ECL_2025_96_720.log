Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=32, checkpoints='./checkpoints/', d_model=512, d_twff=512, d_vwff=512, data='custom', data_path='electricity.csv', des='Exp', devices='0,1,2,3', do_predict=False, dropout=0.2, e_layers=3, embed='timeF', enc_in=321, features='M', flatten_mod=1, freq='h', gpu=0, head_dropout=0.1, init_residual_weight_list=[1.0, 1.0, 1.0], inverse=False, is_training=1, itr=1, label_len=0, learning_rate=0.001, loss='MSE', lradj='type1', mask=0, mod=0, model='L3former', model_id='ECL_96_720', n_heads=8, num_workers=10, output_attention=False, patience=10, pct_start=0.2, pred_len=720, random_seed=2025, revin=1, root_path='./dataset/electricity/', seq_len=96, target='OT', train_epochs=10, train_residual_weight=1, use_L3Linear=0, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm_in_former=1, use_pooling_init=0, use_scheduler=0, use_std_in_revin=1, use_vwff=1, vwff_dropout=0.8, window_size_list=[3, 7])
Use GPU: cuda:0
>>>>>>>start training : ECL_96_720_L3former_custom_M_ft96_sl0_ll720_pl512_dm8_nh3_el512_dftimeF_ebExp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3614323
	speed: 0.0886s/iter; left time: 477.4805s
	iters: 200, epoch: 1 | loss: 0.3712910
	speed: 0.0836s/iter; left time: 442.1956s
	iters: 300, epoch: 1 | loss: 0.3331716
	speed: 0.0839s/iter; left time: 435.3093s
	iters: 400, epoch: 1 | loss: 0.3399584
	speed: 0.0843s/iter; left time: 429.0317s
	iters: 500, epoch: 1 | loss: 0.2675362
	speed: 0.0843s/iter; left time: 420.4954s
Epoch: 1 cost time: 46.66939687728882
Epoch: 1, Steps: 549 | Train Loss: 0.3450966 Vali Loss: 0.2003168 Test Loss: 0.2179372
Validation loss decreased (inf --> 0.200317).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2808792
	speed: 0.2688s/iter; left time: 1301.7547s
	iters: 200, epoch: 2 | loss: 0.2767819
	speed: 0.0843s/iter; left time: 399.7939s
	iters: 300, epoch: 2 | loss: 0.2513179
	speed: 0.0844s/iter; left time: 391.5903s
	iters: 400, epoch: 2 | loss: 0.2520212
	speed: 0.0850s/iter; left time: 386.1321s
	iters: 500, epoch: 2 | loss: 0.2454489
	speed: 0.0848s/iter; left time: 376.5812s
Epoch: 2 cost time: 46.939162731170654
Epoch: 2, Steps: 549 | Train Loss: 0.2638783 Vali Loss: 0.2030229 Test Loss: 0.2019375
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2540901
	speed: 0.2732s/iter; left time: 1172.8579s
	iters: 200, epoch: 3 | loss: 0.2474031
	speed: 0.0848s/iter; left time: 355.5850s
	iters: 300, epoch: 3 | loss: 0.2479744
	speed: 0.0847s/iter; left time: 346.5345s
	iters: 400, epoch: 3 | loss: 0.2421100
	speed: 0.0847s/iter; left time: 338.3121s
	iters: 500, epoch: 3 | loss: 0.2360745
	speed: 0.0848s/iter; left time: 330.2106s
Epoch: 3 cost time: 46.95426559448242
Epoch: 3, Steps: 549 | Train Loss: 0.2442636 Vali Loss: 0.1942639 Test Loss: 0.1965656
Validation loss decreased (0.200317 --> 0.194264).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2397524
	speed: 0.2719s/iter; left time: 1018.0317s
	iters: 200, epoch: 4 | loss: 0.2507033
	speed: 0.0847s/iter; left time: 308.6178s
	iters: 300, epoch: 4 | loss: 0.2352616
	speed: 0.0850s/iter; left time: 301.1032s
	iters: 400, epoch: 4 | loss: 0.2298778
	speed: 0.0850s/iter; left time: 292.5967s
	iters: 500, epoch: 4 | loss: 0.2301127
	speed: 0.0850s/iter; left time: 284.2964s
Epoch: 4 cost time: 47.138216495513916
Epoch: 4, Steps: 549 | Train Loss: 0.2378149 Vali Loss: 0.1939481 Test Loss: 0.1948949
Validation loss decreased (0.194264 --> 0.193948).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2387609
	speed: 0.2705s/iter; left time: 864.2780s
	iters: 200, epoch: 5 | loss: 0.2267155
	speed: 0.0850s/iter; left time: 262.9475s
	iters: 300, epoch: 5 | loss: 0.2349432
	speed: 0.0846s/iter; left time: 253.4122s
	iters: 400, epoch: 5 | loss: 0.2424396
	speed: 0.0846s/iter; left time: 244.8502s
	iters: 500, epoch: 5 | loss: 0.2299650
	speed: 0.0846s/iter; left time: 236.3174s
Epoch: 5 cost time: 47.14269137382507
Epoch: 5, Steps: 549 | Train Loss: 0.2348358 Vali Loss: 0.1940912 Test Loss: 0.1944390
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2275536
	speed: 0.2693s/iter; left time: 712.6529s
	iters: 200, epoch: 6 | loss: 0.2396735
	speed: 0.0850s/iter; left time: 216.5200s
	iters: 300, epoch: 6 | loss: 0.2336457
	speed: 0.0849s/iter; left time: 207.7701s
	iters: 400, epoch: 6 | loss: 0.2289444
	speed: 0.0850s/iter; left time: 199.3512s
	iters: 500, epoch: 6 | loss: 0.2283919
	speed: 0.0850s/iter; left time: 190.8862s
Epoch: 6 cost time: 47.146931886672974
Epoch: 6, Steps: 549 | Train Loss: 0.2330853 Vali Loss: 0.1951998 Test Loss: 0.1944209
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2327721
	speed: 0.2696s/iter; left time: 565.2610s
	iters: 200, epoch: 7 | loss: 0.2528781
	speed: 0.0846s/iter; left time: 169.0202s
	iters: 300, epoch: 7 | loss: 0.2283849
	speed: 0.0847s/iter; left time: 160.6787s
	iters: 400, epoch: 7 | loss: 0.2382682
	speed: 0.0850s/iter; left time: 152.6840s
	iters: 500, epoch: 7 | loss: 0.2319628
	speed: 0.0851s/iter; left time: 144.4692s
Epoch: 7 cost time: 47.01679253578186
Epoch: 7, Steps: 549 | Train Loss: 0.2320624 Vali Loss: 0.1932815 Test Loss: 0.1943459
Validation loss decreased (0.193948 --> 0.193282).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2240003
	speed: 0.2672s/iter; left time: 413.6206s
	iters: 200, epoch: 8 | loss: 0.2343737
	speed: 0.0852s/iter; left time: 123.3574s
	iters: 300, epoch: 8 | loss: 0.2351669
	speed: 0.0849s/iter; left time: 114.4226s
	iters: 400, epoch: 8 | loss: 0.2383562
	speed: 0.0853s/iter; left time: 106.3933s
	iters: 500, epoch: 8 | loss: 0.2367476
	speed: 0.0849s/iter; left time: 97.4484s
Epoch: 8 cost time: 47.162253856658936
Epoch: 8, Steps: 549 | Train Loss: 0.2313900 Vali Loss: 0.1934155 Test Loss: 0.1941884
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2378635
	speed: 0.2702s/iter; left time: 269.9057s
	iters: 200, epoch: 9 | loss: 0.2211866
	speed: 0.0850s/iter; left time: 76.4004s
	iters: 300, epoch: 9 | loss: 0.2291455
	speed: 0.0854s/iter; left time: 68.2291s
	iters: 400, epoch: 9 | loss: 0.2344351
	speed: 0.0849s/iter; left time: 59.3395s
	iters: 500, epoch: 9 | loss: 0.2238137
	speed: 0.0851s/iter; left time: 50.9477s
Epoch: 9 cost time: 47.01682782173157
Epoch: 9, Steps: 549 | Train Loss: 0.2310167 Vali Loss: 0.1931640 Test Loss: 0.1941867
Validation loss decreased (0.193282 --> 0.193164).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2568937
	speed: 0.2713s/iter; left time: 122.0907s
	iters: 200, epoch: 10 | loss: 0.2197659
	speed: 0.0849s/iter; left time: 29.7213s
	iters: 300, epoch: 10 | loss: 0.2249210
	speed: 0.0850s/iter; left time: 21.2475s
	iters: 400, epoch: 10 | loss: 0.2317647
	speed: 0.0852s/iter; left time: 12.7757s
	iters: 500, epoch: 10 | loss: 0.2387014
	speed: 0.0851s/iter; left time: 4.2565s
Epoch: 10 cost time: 47.06078815460205
Epoch: 10, Steps: 549 | Train Loss: 0.2307767 Vali Loss: 0.1936390 Test Loss: 0.1941610
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
>>>>>>>testing : ECL_96_720_L3former_custom_M_ft96_sl0_ll720_pl512_dm8_nh3_el512_dftimeF_ebExp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.19411548972129822, mae:0.28914913535118103
