Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=32, checkpoints='./checkpoints/', d_model=512, d_twff=512, d_vwff=128, data='custom', data_path='electricity.csv', des='Exp', devices='0,1,2,3', do_predict=False, dropout=0.2, e_layers=3, embed='timeF', enc_in=321, features='M', flatten_mod=1, freq='h', gpu=0, head_dropout=0.1, init_residual_weight_list=[1.0, 1.0, 1.0], inverse=False, is_training=1, itr=1, label_len=0, learning_rate=0.001, loss='MSE', lradj='type1', mask=0, mod=0, model='L3former', model_id='ECL_96_96', n_heads=8, num_workers=10, output_attention=False, patience=10, pct_start=0.2, pred_len=96, random_seed=2025, revin=1, root_path='./dataset/electricity/', seq_len=96, target='OT', train_epochs=10, train_residual_weight=1, use_L3Linear=0, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm_in_former=1, use_pooling_init=0, use_scheduler=0, use_std_in_revin=1, use_vwff=1, vwff_dropout=0.8, window_size_list=[3, 7])
Use GPU: cuda:0
>>>>>>>start training : ECL_96_96_L3former_custom_M_ft96_sl0_ll96_pl512_dm8_nh3_el512_dftimeF_ebExp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3112642
	speed: 0.0727s/iter; left time: 406.5152s
	iters: 200, epoch: 1 | loss: 0.2502980
	speed: 0.0677s/iter; left time: 371.6114s
	iters: 300, epoch: 1 | loss: 0.2353126
	speed: 0.0681s/iter; left time: 367.0938s
	iters: 400, epoch: 1 | loss: 0.2413480
	speed: 0.0683s/iter; left time: 361.1372s
	iters: 500, epoch: 1 | loss: 0.2327395
	speed: 0.0683s/iter; left time: 354.4085s
Epoch: 1 cost time: 39.263644218444824
Epoch: 1, Steps: 569 | Train Loss: 0.2710222 Vali Loss: 0.1401564 Test Loss: 0.1581467
Validation loss decreased (inf --> 0.140156).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2203213
	speed: 0.1943s/iter; left time: 975.7332s
	iters: 200, epoch: 2 | loss: 0.2345872
	speed: 0.0682s/iter; left time: 335.9043s
	iters: 300, epoch: 2 | loss: 0.2246868
	speed: 0.0685s/iter; left time: 330.3326s
	iters: 400, epoch: 2 | loss: 0.2269646
	speed: 0.0685s/iter; left time: 323.2733s
	iters: 500, epoch: 2 | loss: 0.2377139
	speed: 0.0684s/iter; left time: 316.1950s
Epoch: 2 cost time: 39.17635774612427
Epoch: 2, Steps: 569 | Train Loss: 0.2239536 Vali Loss: 0.1306737 Test Loss: 0.1490547
Validation loss decreased (0.140156 --> 0.130674).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2235200
	speed: 0.1971s/iter; left time: 877.6398s
	iters: 200, epoch: 3 | loss: 0.2048374
	speed: 0.0683s/iter; left time: 297.3655s
	iters: 300, epoch: 3 | loss: 0.2094329
	speed: 0.0681s/iter; left time: 289.5460s
	iters: 400, epoch: 3 | loss: 0.2120952
	speed: 0.0682s/iter; left time: 283.3635s
	iters: 500, epoch: 3 | loss: 0.2261420
	speed: 0.0685s/iter; left time: 277.4867s
Epoch: 3 cost time: 39.136208057403564
Epoch: 3, Steps: 569 | Train Loss: 0.2113975 Vali Loss: 0.1288678 Test Loss: 0.1484041
Validation loss decreased (0.130674 --> 0.128868).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1951712
	speed: 0.1973s/iter; left time: 766.1637s
	iters: 200, epoch: 4 | loss: 0.2104142
	speed: 0.0683s/iter; left time: 258.4181s
	iters: 300, epoch: 4 | loss: 0.1948514
	speed: 0.0684s/iter; left time: 251.9203s
	iters: 400, epoch: 4 | loss: 0.2079406
	speed: 0.0684s/iter; left time: 245.1493s
	iters: 500, epoch: 4 | loss: 0.1942744
	speed: 0.0684s/iter; left time: 238.2597s
Epoch: 4 cost time: 39.167842388153076
Epoch: 4, Steps: 569 | Train Loss: 0.2043076 Vali Loss: 0.1245277 Test Loss: 0.1434282
Validation loss decreased (0.128868 --> 0.124528).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1795221
	speed: 0.1974s/iter; left time: 654.3122s
	iters: 200, epoch: 5 | loss: 0.2006724
	speed: 0.0684s/iter; left time: 219.9416s
	iters: 300, epoch: 5 | loss: 0.2083743
	speed: 0.0686s/iter; left time: 213.5926s
	iters: 400, epoch: 5 | loss: 0.1981459
	speed: 0.0685s/iter; left time: 206.5768s
	iters: 500, epoch: 5 | loss: 0.2026632
	speed: 0.0686s/iter; left time: 200.0379s
Epoch: 5 cost time: 39.274470806121826
Epoch: 5, Steps: 569 | Train Loss: 0.2007139 Vali Loss: 0.1229121 Test Loss: 0.1418471
Validation loss decreased (0.124528 --> 0.122912).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1807347
	speed: 0.1975s/iter; left time: 542.3302s
	iters: 200, epoch: 6 | loss: 0.1877583
	speed: 0.0681s/iter; left time: 180.2271s
	iters: 300, epoch: 6 | loss: 0.1966691
	speed: 0.0682s/iter; left time: 173.6961s
	iters: 400, epoch: 6 | loss: 0.1871387
	speed: 0.0684s/iter; left time: 167.2740s
	iters: 500, epoch: 6 | loss: 0.2021999
	speed: 0.0685s/iter; left time: 160.7217s
Epoch: 6 cost time: 39.21659827232361
Epoch: 6, Steps: 569 | Train Loss: 0.1988468 Vali Loss: 0.1215752 Test Loss: 0.1407915
Validation loss decreased (0.122912 --> 0.121575).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1946778
	speed: 0.1985s/iter; left time: 432.1794s
	iters: 200, epoch: 7 | loss: 0.1945655
	speed: 0.0684s/iter; left time: 142.1593s
	iters: 300, epoch: 7 | loss: 0.2073229
	speed: 0.0685s/iter; left time: 135.5097s
	iters: 400, epoch: 7 | loss: 0.1912971
	speed: 0.0684s/iter; left time: 128.3422s
	iters: 500, epoch: 7 | loss: 0.2044179
	speed: 0.0683s/iter; left time: 121.4002s
Epoch: 7 cost time: 39.30359244346619
Epoch: 7, Steps: 569 | Train Loss: 0.1978551 Vali Loss: 0.1216537 Test Loss: 0.1406945
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2068768
	speed: 0.1976s/iter; left time: 317.6943s
	iters: 200, epoch: 8 | loss: 0.1935043
	speed: 0.0685s/iter; left time: 103.2592s
	iters: 300, epoch: 8 | loss: 0.1966832
	speed: 0.0683s/iter; left time: 96.1577s
	iters: 400, epoch: 8 | loss: 0.1948349
	speed: 0.0684s/iter; left time: 89.4896s
	iters: 500, epoch: 8 | loss: 0.1877035
	speed: 0.0683s/iter; left time: 82.5322s
Epoch: 8 cost time: 39.18766236305237
Epoch: 8, Steps: 569 | Train Loss: 0.1973540 Vali Loss: 0.1209118 Test Loss: 0.1401207
Validation loss decreased (0.121575 --> 0.120912).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2051975
	speed: 0.1976s/iter; left time: 205.2967s
	iters: 200, epoch: 9 | loss: 0.2000929
	speed: 0.0681s/iter; left time: 63.9831s
	iters: 300, epoch: 9 | loss: 0.1985198
	speed: 0.0683s/iter; left time: 57.3416s
	iters: 400, epoch: 9 | loss: 0.1916633
	speed: 0.0684s/iter; left time: 50.5495s
	iters: 500, epoch: 9 | loss: 0.1907359
	speed: 0.0684s/iter; left time: 43.6848s
Epoch: 9 cost time: 39.20122218132019
Epoch: 9, Steps: 569 | Train Loss: 0.1970537 Vali Loss: 0.1208924 Test Loss: 0.1400423
Validation loss decreased (0.120912 --> 0.120892).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1941167
	speed: 0.2010s/iter; left time: 94.4867s
	iters: 200, epoch: 10 | loss: 0.1991638
	speed: 0.0685s/iter; left time: 25.3399s
	iters: 300, epoch: 10 | loss: 0.1937997
	speed: 0.0685s/iter; left time: 18.5057s
	iters: 400, epoch: 10 | loss: 0.2043763
	speed: 0.0683s/iter; left time: 11.6143s
	iters: 500, epoch: 10 | loss: 0.2057797
	speed: 0.0682s/iter; left time: 4.7749s
Epoch: 10 cost time: 39.743361949920654
Epoch: 10, Steps: 569 | Train Loss: 0.1969335 Vali Loss: 0.1209281 Test Loss: 0.1400366
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
>>>>>>>testing : ECL_96_96_L3former_custom_M_ft96_sl0_ll96_pl512_dm8_nh3_el512_dftimeF_ebExp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13986963033676147, mae:0.23764926195144653
