Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=16, checkpoints='./checkpoints/', d_model=512, d_twff=512, d_vwff=0, data='custom', data_path='traffic.csv', des='Exp', devices='0,1,2,3', do_predict=False, dropout=0.1, e_layers=4, embed='timeF', enc_in=862, features='M', flatten_mod=1, freq='h', gpu=0, head_dropout=0.1, init_residual_weight_list=[2.0, 1.0, 1.0], inverse=False, is_training=1, itr=1, label_len=0, learning_rate=0.001, loss='MSE', lradj='TST', mask=0, mod=0, model='L3former', model_id='traffic_96_96', n_heads=8, num_workers=10, output_attention=False, patience=5, pct_start=0.2, pred_len=96, random_seed=2025, revin=1, root_path='./dataset/traffic/', seq_len=96, target='OT', train_epochs=20, train_residual_weight=0, use_L3Linear=0, use_amp=True, use_gpu=True, use_multi_gpu=False, use_norm_in_former=1, use_pooling_init=0, use_scheduler=0, use_std_in_revin=1, use_vwff=0, vwff_dropout=0.8, window_size_list=[3, 7, 15, 27, 43])
Use GPU: cuda:0
>>>>>>>start training : traffic_96_96_L3former_custom_M_ft96_sl0_ll96_pl512_dm8_nh4_el512_dftimeF_ebExp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5434870
	speed: 0.1050s/iter; left time: 1575.2742s
	iters: 200, epoch: 1 | loss: 0.5393067
	speed: 0.0998s/iter; left time: 1487.5409s
	iters: 300, epoch: 1 | loss: 0.5351185
	speed: 0.1001s/iter; left time: 1482.0520s
	iters: 400, epoch: 1 | loss: 0.4525921
	speed: 0.1002s/iter; left time: 1472.6214s
	iters: 500, epoch: 1 | loss: 0.4002970
	speed: 0.1000s/iter; left time: 1459.6304s
	iters: 600, epoch: 1 | loss: 0.4326888
	speed: 0.1007s/iter; left time: 1460.3279s
	iters: 700, epoch: 1 | loss: 0.4237842
	speed: 0.1000s/iter; left time: 1439.9558s
Epoch: 1 cost time: 76.1630003452301
Epoch: 1, Steps: 755 | Train Loss: 0.4894320 Vali Loss: 0.4651074 Test Loss: 0.5242545
Validation loss decreased (inf --> 0.465107).  Saving model ...
Updating learning rate to 0.0001806770549502971
	iters: 100, epoch: 2 | loss: 0.4281839
	speed: 0.2939s/iter; left time: 4186.8040s
	iters: 200, epoch: 2 | loss: 0.4041904
	speed: 0.0988s/iter; left time: 1397.5328s
	iters: 300, epoch: 2 | loss: 0.4266986
	speed: 0.0988s/iter; left time: 1387.5489s
	iters: 400, epoch: 2 | loss: 0.4237900
	speed: 0.0995s/iter; left time: 1388.1124s
	iters: 500, epoch: 2 | loss: 0.3631900
	speed: 0.0990s/iter; left time: 1370.9878s
	iters: 600, epoch: 2 | loss: 0.3640638
	speed: 0.0991s/iter; left time: 1361.9274s
	iters: 700, epoch: 2 | loss: 0.3708498
	speed: 0.0993s/iter; left time: 1355.0094s
Epoch: 2 cost time: 75.3576729297638
Epoch: 2, Steps: 755 | Train Loss: 0.4001084 Vali Loss: 0.4491795 Test Loss: 0.4996749
Validation loss decreased (0.465107 --> 0.449180).  Saving model ...
Updating learning rate to 0.0005202497456783181
	iters: 100, epoch: 3 | loss: 0.3449630
	speed: 0.2981s/iter; left time: 4022.1019s
	iters: 200, epoch: 3 | loss: 0.3841314
	speed: 0.0990s/iter; left time: 1325.7551s
	iters: 300, epoch: 3 | loss: 0.3518713
	speed: 0.0989s/iter; left time: 1315.0802s
	iters: 400, epoch: 3 | loss: 0.3735713
	speed: 0.0990s/iter; left time: 1306.0155s
	iters: 500, epoch: 3 | loss: 0.3967537
	speed: 0.0981s/iter; left time: 1284.5619s
	iters: 600, epoch: 3 | loss: 0.4008951
	speed: 0.0985s/iter; left time: 1279.7543s
	iters: 700, epoch: 3 | loss: 0.3783012
	speed: 0.0989s/iter; left time: 1275.0205s
Epoch: 3 cost time: 74.95979690551758
Epoch: 3, Steps: 755 | Train Loss: 0.3812884 Vali Loss: 0.4364180 Test Loss: 0.4827633
Validation loss decreased (0.449180 --> 0.436418).  Saving model ...
Updating learning rate to 0.0008596760468792042
	iters: 100, epoch: 4 | loss: 0.3783154
	speed: 0.2902s/iter; left time: 3696.2176s
	iters: 200, epoch: 4 | loss: 0.3391362
	speed: 0.0987s/iter; left time: 1247.6141s
	iters: 300, epoch: 4 | loss: 0.3442843
	speed: 0.0982s/iter; left time: 1231.5458s
	iters: 400, epoch: 4 | loss: 0.3468719
	speed: 0.0981s/iter; left time: 1220.5045s
	iters: 500, epoch: 4 | loss: 0.3731204
	speed: 0.0986s/iter; left time: 1216.5349s
	iters: 600, epoch: 4 | loss: 0.3626876
	speed: 0.0983s/iter; left time: 1203.3332s
	iters: 700, epoch: 4 | loss: 0.3360929
	speed: 0.0984s/iter; left time: 1194.7207s
Epoch: 4 cost time: 74.7686538696289
Epoch: 4, Steps: 755 | Train Loss: 0.3717948 Vali Loss: 0.4255161 Test Loss: 0.4726865
Validation loss decreased (0.436418 --> 0.425516).  Saving model ...
Updating learning rate to 0.0009999999830915365
	iters: 100, epoch: 5 | loss: 0.3631124
	speed: 0.2900s/iter; left time: 3474.1538s
	iters: 200, epoch: 5 | loss: 0.3297887
	speed: 0.0977s/iter; left time: 1160.7376s
	iters: 300, epoch: 5 | loss: 0.3737825
	speed: 0.0982s/iter; left time: 1156.6300s
	iters: 400, epoch: 5 | loss: 0.3628192
	speed: 0.0981s/iter; left time: 1146.1118s
	iters: 500, epoch: 5 | loss: 0.3627040
	speed: 0.0989s/iter; left time: 1145.2531s
	iters: 600, epoch: 5 | loss: 0.3784662
	speed: 0.0994s/iter; left time: 1141.5354s
	iters: 700, epoch: 5 | loss: 0.3283263
	speed: 0.0989s/iter; left time: 1125.8865s
Epoch: 5 cost time: 74.73486804962158
Epoch: 5, Steps: 755 | Train Loss: 0.3644052 Vali Loss: 0.4290291 Test Loss: 0.4744012
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000990367294006756
	iters: 100, epoch: 6 | loss: 0.3156091
	speed: 0.2862s/iter; left time: 3212.3953s
	iters: 200, epoch: 6 | loss: 0.3476103
	speed: 0.0984s/iter; left time: 1094.6933s
	iters: 300, epoch: 6 | loss: 0.3814374
	speed: 0.0988s/iter; left time: 1089.5963s
	iters: 400, epoch: 6 | loss: 0.3744741
	speed: 0.0986s/iter; left time: 1077.3037s
	iters: 500, epoch: 6 | loss: 0.3482278
	speed: 0.0996s/iter; left time: 1078.2992s
	iters: 600, epoch: 6 | loss: 0.3709053
	speed: 0.0988s/iter; left time: 1059.5633s
	iters: 700, epoch: 6 | loss: 0.3796141
	speed: 0.0981s/iter; left time: 1042.0151s
Epoch: 6 cost time: 74.9632613658905
Epoch: 6, Steps: 755 | Train Loss: 0.3607619 Vali Loss: 0.4161216 Test Loss: 0.4594025
Validation loss decreased (0.425516 --> 0.416122).  Saving model ...
Updating learning rate to 0.0009618901416733209
	iters: 100, epoch: 7 | loss: 0.4016834
	speed: 0.2858s/iter; left time: 2992.4600s
	iters: 200, epoch: 7 | loss: 0.3331579
	speed: 0.0981s/iter; left time: 1017.8699s
	iters: 300, epoch: 7 | loss: 0.3432156
	speed: 0.0981s/iter; left time: 1008.0858s
	iters: 400, epoch: 7 | loss: 0.3764911
	speed: 0.0981s/iter; left time: 998.1714s
	iters: 500, epoch: 7 | loss: 0.3460831
	speed: 0.0982s/iter; left time: 989.3801s
	iters: 600, epoch: 7 | loss: 0.3301407
	speed: 0.0978s/iter; left time: 974.7422s
	iters: 700, epoch: 7 | loss: 0.3603013
	speed: 0.0974s/iter; left time: 960.9585s
Epoch: 7 cost time: 74.28136658668518
Epoch: 7, Steps: 755 | Train Loss: 0.3575691 Vali Loss: 0.4135137 Test Loss: 0.4598896
Validation loss decreased (0.416122 --> 0.413514).  Saving model ...
Updating learning rate to 0.0009156628870852342
	iters: 100, epoch: 8 | loss: 0.3185876
	speed: 0.2941s/iter; left time: 2857.2030s
	iters: 200, epoch: 8 | loss: 0.3617863
	speed: 0.0992s/iter; left time: 953.5722s
	iters: 300, epoch: 8 | loss: 0.3464558
	speed: 0.0990s/iter; left time: 941.7183s
	iters: 400, epoch: 8 | loss: 0.3523965
	speed: 0.0990s/iter; left time: 932.3149s
	iters: 500, epoch: 8 | loss: 0.3366449
	speed: 0.0990s/iter; left time: 921.9247s
	iters: 600, epoch: 8 | loss: 0.3519924
	speed: 0.0996s/iter; left time: 918.3100s
	iters: 700, epoch: 8 | loss: 0.3466492
	speed: 0.0994s/iter; left time: 905.9764s
Epoch: 8 cost time: 75.26449775695801
Epoch: 8, Steps: 755 | Train Loss: 0.3548526 Vali Loss: 0.4173996 Test Loss: 0.4618224
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0008534620177117731
	iters: 100, epoch: 9 | loss: 0.3550055
	speed: 0.2939s/iter; left time: 2634.0233s
	iters: 200, epoch: 9 | loss: 0.3490191
	speed: 0.0983s/iter; left time: 871.4685s
	iters: 300, epoch: 9 | loss: 0.3458996
	speed: 0.0998s/iter; left time: 873.9212s
	iters: 400, epoch: 9 | loss: 0.3636901
	speed: 0.1002s/iter; left time: 867.6107s
	iters: 500, epoch: 9 | loss: 0.3248569
	speed: 0.1001s/iter; left time: 856.6102s
	iters: 600, epoch: 9 | loss: 0.3338737
	speed: 0.0998s/iter; left time: 844.1982s
	iters: 700, epoch: 9 | loss: 0.3872078
	speed: 0.0997s/iter; left time: 833.5597s
Epoch: 9 cost time: 75.73154377937317
Epoch: 9, Steps: 755 | Train Loss: 0.3513472 Vali Loss: 0.4073303 Test Loss: 0.4480063
Validation loss decreased (0.413514 --> 0.407330).  Saving model ...
Updating learning rate to 0.00077767787808031
	iters: 100, epoch: 10 | loss: 0.3305144
	speed: 0.2900s/iter; left time: 2379.4963s
	iters: 200, epoch: 10 | loss: 0.3334846
	speed: 0.0996s/iter; left time: 807.0024s
	iters: 300, epoch: 10 | loss: 0.3315575
	speed: 0.0994s/iter; left time: 795.5267s
	iters: 400, epoch: 10 | loss: 0.3779682
	speed: 0.0998s/iter; left time: 788.8833s
	iters: 500, epoch: 10 | loss: 0.3522674
	speed: 0.1002s/iter; left time: 782.0092s
	iters: 600, epoch: 10 | loss: 0.3804994
	speed: 0.1001s/iter; left time: 771.5234s
	iters: 700, epoch: 10 | loss: 0.3679207
	speed: 0.0995s/iter; left time: 756.5863s
Epoch: 10 cost time: 75.61062669754028
Epoch: 10, Steps: 755 | Train Loss: 0.3478501 Vali Loss: 0.4050184 Test Loss: 0.4464782
Validation loss decreased (0.407330 --> 0.405018).  Saving model ...
Updating learning rate to 0.0006912228101766472
	iters: 100, epoch: 11 | loss: 0.3414400
	speed: 0.2891s/iter; left time: 2153.8187s
	iters: 200, epoch: 11 | loss: 0.3443608
	speed: 0.0991s/iter; left time: 728.3819s
	iters: 300, epoch: 11 | loss: 0.3273095
	speed: 0.0986s/iter; left time: 714.9051s
	iters: 400, epoch: 11 | loss: 0.3885669
	speed: 0.0991s/iter; left time: 708.5581s
	iters: 500, epoch: 11 | loss: 0.3442535
	speed: 0.0987s/iter; left time: 696.0217s
	iters: 600, epoch: 11 | loss: 0.3205683
	speed: 0.0980s/iter; left time: 681.2956s
	iters: 700, epoch: 11 | loss: 0.3542084
	speed: 0.0982s/iter; left time: 672.6322s
Epoch: 11 cost time: 74.72164702415466
Epoch: 11, Steps: 755 | Train Loss: 0.3442674 Vali Loss: 0.4036215 Test Loss: 0.4430378
Validation loss decreased (0.405018 --> 0.403621).  Saving model ...
Updating learning rate to 0.0005974192337757615
	iters: 100, epoch: 12 | loss: 0.3291332
	speed: 0.2889s/iter; left time: 1934.3276s
	iters: 200, epoch: 12 | loss: 0.3132936
	speed: 0.0989s/iter; left time: 652.3988s
	iters: 300, epoch: 12 | loss: 0.3400937
	speed: 0.0986s/iter; left time: 640.7941s
	iters: 400, epoch: 12 | loss: 0.3304074
	speed: 0.0990s/iter; left time: 633.0538s
	iters: 500, epoch: 12 | loss: 0.3562665
	speed: 0.0980s/iter; left time: 616.8158s
	iters: 600, epoch: 12 | loss: 0.3027377
	speed: 0.0977s/iter; left time: 605.1586s
	iters: 700, epoch: 12 | loss: 0.3516527
	speed: 0.0980s/iter; left time: 597.2352s
Epoch: 12 cost time: 74.67603850364685
Epoch: 12, Steps: 755 | Train Loss: 0.3408507 Vali Loss: 0.3958950 Test Loss: 0.4353628
Validation loss decreased (0.403621 --> 0.395895).  Saving model ...
Updating learning rate to 0.0004998719677130875
	iters: 100, epoch: 13 | loss: 0.3637890
	speed: 0.2876s/iter; left time: 1708.5395s
	iters: 200, epoch: 13 | loss: 0.3336420
	speed: 0.0981s/iter; left time: 573.2116s
	iters: 300, epoch: 13 | loss: 0.3986914
	speed: 0.0983s/iter; left time: 564.6157s
	iters: 400, epoch: 13 | loss: 0.3224340
	speed: 0.0985s/iter; left time: 555.7859s
	iters: 500, epoch: 13 | loss: 0.3544451
	speed: 0.0972s/iter; left time: 538.4182s
	iters: 600, epoch: 13 | loss: 0.3035121
	speed: 0.0977s/iter; left time: 531.8440s
	iters: 700, epoch: 13 | loss: 0.3606767
	speed: 0.0982s/iter; left time: 524.5563s
Epoch: 13 cost time: 74.40609455108643
Epoch: 13, Steps: 755 | Train Loss: 0.3372498 Vali Loss: 0.3895206 Test Loss: 0.4284862
Validation loss decreased (0.395895 --> 0.389521).  Saving model ...
Updating learning rate to 0.00040232969871827664
	iters: 100, epoch: 14 | loss: 0.3189274
	speed: 0.2864s/iter; left time: 1485.0851s
	iters: 200, epoch: 14 | loss: 0.3483306
	speed: 0.0978s/iter; left time: 497.2830s
	iters: 300, epoch: 14 | loss: 0.3395152
	speed: 0.0987s/iter; left time: 491.9188s
	iters: 400, epoch: 14 | loss: 0.3135147
	speed: 0.0973s/iter; left time: 475.2652s
	iters: 500, epoch: 14 | loss: 0.3160846
	speed: 0.0976s/iter; left time: 466.9966s
	iters: 600, epoch: 14 | loss: 0.3256564
	speed: 0.0984s/iter; left time: 461.0719s
	iters: 700, epoch: 14 | loss: 0.3156459
	speed: 0.0977s/iter; left time: 447.9271s
Epoch: 14 cost time: 74.29931616783142
Epoch: 14, Steps: 755 | Train Loss: 0.3334959 Vali Loss: 0.3885346 Test Loss: 0.4269329
Validation loss decreased (0.389521 --> 0.388535).  Saving model ...
Updating learning rate to 0.0003085409214864647
	iters: 100, epoch: 15 | loss: 0.3142456
	speed: 0.2885s/iter; left time: 1278.4800s
	iters: 200, epoch: 15 | loss: 0.3099583
	speed: 0.0970s/iter; left time: 419.8970s
	iters: 300, epoch: 15 | loss: 0.3290610
	speed: 0.0990s/iter; left time: 418.9138s
	iters: 400, epoch: 15 | loss: 0.3405635
	speed: 0.0980s/iter; left time: 404.9291s
	iters: 500, epoch: 15 | loss: 0.3089101
	speed: 0.0986s/iter; left time: 397.5996s
	iters: 600, epoch: 15 | loss: 0.3210942
	speed: 0.0985s/iter; left time: 387.2881s
	iters: 700, epoch: 15 | loss: 0.3485386
	speed: 0.0983s/iter; left time: 376.7514s
Epoch: 15 cost time: 74.55261087417603
Epoch: 15, Steps: 755 | Train Loss: 0.3300666 Vali Loss: 0.3850823 Test Loss: 0.4228533
Validation loss decreased (0.388535 --> 0.385082).  Saving model ...
Updating learning rate to 0.00022210988612931802
	iters: 100, epoch: 16 | loss: 0.3693594
	speed: 0.2858s/iter; left time: 1050.7725s
	iters: 200, epoch: 16 | loss: 0.3122805
	speed: 0.0970s/iter; left time: 346.7629s
	iters: 300, epoch: 16 | loss: 0.3228671
	speed: 0.0983s/iter; left time: 341.7529s
	iters: 400, epoch: 16 | loss: 0.2921232
	speed: 0.0981s/iter; left time: 331.2652s
	iters: 500, epoch: 16 | loss: 0.3458377
	speed: 0.0988s/iter; left time: 323.8106s
	iters: 600, epoch: 16 | loss: 0.3241404
	speed: 0.0986s/iter; left time: 313.0593s
	iters: 700, epoch: 16 | loss: 0.3804320
	speed: 0.0983s/iter; left time: 302.2418s
Epoch: 16 cost time: 74.40837240219116
Epoch: 16, Steps: 755 | Train Loss: 0.3272304 Vali Loss: 0.3838394 Test Loss: 0.4200930
Validation loss decreased (0.385082 --> 0.383839).  Saving model ...
Updating learning rate to 0.00014635808886452893
	iters: 100, epoch: 17 | loss: 0.3103772
	speed: 0.2874s/iter; left time: 839.5315s
	iters: 200, epoch: 17 | loss: 0.3265202
	speed: 0.0977s/iter; left time: 275.7041s
	iters: 300, epoch: 17 | loss: 0.2873180
	speed: 0.0976s/iter; left time: 265.6504s
	iters: 400, epoch: 17 | loss: 0.3057768
	speed: 0.0983s/iter; left time: 257.5740s
	iters: 500, epoch: 17 | loss: 0.3354595
	speed: 0.0986s/iter; left time: 248.6963s
	iters: 600, epoch: 17 | loss: 0.3255966
	speed: 0.0982s/iter; left time: 237.7250s
	iters: 700, epoch: 17 | loss: 0.3097754
	speed: 0.0982s/iter; left time: 228.0339s
Epoch: 17 cost time: 74.52716159820557
Epoch: 17, Steps: 755 | Train Loss: 0.3245196 Vali Loss: 0.3824885 Test Loss: 0.4178605
Validation loss decreased (0.383839 --> 0.382488).  Saving model ...
Updating learning rate to 8.419662877888557e-05
	iters: 100, epoch: 18 | loss: 0.3148255
	speed: 0.2871s/iter; left time: 621.8438s
	iters: 200, epoch: 18 | loss: 0.2869019
	speed: 0.0987s/iter; left time: 203.9445s
	iters: 300, epoch: 18 | loss: 0.3026272
	speed: 0.0986s/iter; left time: 193.8174s
	iters: 400, epoch: 18 | loss: 0.3064815
	speed: 0.0988s/iter; left time: 184.2794s
	iters: 500, epoch: 18 | loss: 0.3305990
	speed: 0.0989s/iter; left time: 174.5916s
	iters: 600, epoch: 18 | loss: 0.3325405
	speed: 0.0988s/iter; left time: 164.6571s
	iters: 700, epoch: 18 | loss: 0.3262178
	speed: 0.0985s/iter; left time: 154.2336s
Epoch: 18 cost time: 74.72022914886475
Epoch: 18, Steps: 755 | Train Loss: 0.3225070 Vali Loss: 0.3804824 Test Loss: 0.4164109
Validation loss decreased (0.382488 --> 0.380482).  Saving model ...
Updating learning rate to 3.8014335922931126e-05
	iters: 100, epoch: 19 | loss: 0.3272293
	speed: 0.2858s/iter; left time: 403.2969s
	iters: 200, epoch: 19 | loss: 0.3388825
	speed: 0.0985s/iter; left time: 129.0818s
	iters: 300, epoch: 19 | loss: 0.2924530
	speed: 0.0990s/iter; left time: 119.8589s
	iters: 400, epoch: 19 | loss: 0.3524922
	speed: 0.0988s/iter; left time: 109.7812s
	iters: 500, epoch: 19 | loss: 0.3235332
	speed: 0.0988s/iter; left time: 99.9077s
	iters: 600, epoch: 19 | loss: 0.2916308
	speed: 0.0982s/iter; left time: 89.4717s
	iters: 700, epoch: 19 | loss: 0.3222304
	speed: 0.0988s/iter; left time: 80.1185s
Epoch: 19 cost time: 74.7983148097992
Epoch: 19, Steps: 755 | Train Loss: 0.3211021 Vali Loss: 0.3795391 Test Loss: 0.4149774
Validation loss decreased (0.380482 --> 0.379539).  Saving model ...
Updating learning rate to 9.585969911791509e-06
	iters: 100, epoch: 20 | loss: 0.2993716
	speed: 0.2892s/iter; left time: 189.7173s
	iters: 200, epoch: 20 | loss: 0.3251300
	speed: 0.0985s/iter; left time: 54.7644s
	iters: 300, epoch: 20 | loss: 0.3571360
	speed: 0.0986s/iter; left time: 44.9413s
	iters: 400, epoch: 20 | loss: 0.3206190
	speed: 0.0984s/iter; left time: 35.0228s
	iters: 500, epoch: 20 | loss: 0.3223420
	speed: 0.0973s/iter; left time: 24.9055s
	iters: 600, epoch: 20 | loss: 0.3373353
	speed: 0.0989s/iter; left time: 15.4265s
	iters: 700, epoch: 20 | loss: 0.3274317
	speed: 0.0988s/iter; left time: 5.5301s
Epoch: 20 cost time: 74.69334673881531
Epoch: 20, Steps: 755 | Train Loss: 0.3203413 Vali Loss: 0.3801896 Test Loss: 0.4155121
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.016908463552175e-09
>>>>>>>testing : traffic_96_96_L3former_custom_M_ft96_sl0_ll96_pl512_dm8_nh4_el512_dftimeF_ebExp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4156440496444702, mae:0.2665322721004486
